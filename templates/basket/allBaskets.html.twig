{% extends 'base.html.twig' %}

{% block title %}Paniers{% endblock %}

{% block body %}
{#
    {{ dump(baskets[0].basketContents) }}
#}
<h1>Tous les paniers</h1>
{#{{ dump(baskets) }}#}
    <table class="table">
        <thead>
        <tr>
            <th>Id</th>
            <th>State</th>
            <th>Utilisateur</th>
            <th>Produit</th>
            <th>Prix total de la commande</th>
        </tr>
        </thead>
        <tbody>
            {% set sumAmountBasket = 0%}
            {% for b in baskets %}
                {# Si panier est brouillon il est affiché #}
                {% if b.state == null %}
                    <tr>
                        <td>{{ b.id }}</td>
                        <td>
                            {% if b.state == null %}
                                Brouillon
                            {% else %}
                                Confirmée
                            {% endif %}
                        </td>
                        <td>{{ b.owner }}</td>
                        <td>
                            {% for bc in b.basketContents %}
                                <div>
                                    {#{{ dump(bc) }}#}
                                    <b>{{ bc.quantity}} {{ bc.products }}{{ bc.quantity > 1 ? 's' : ''}}</b><br/>
                                    - Prix unité : {{ bc.products.prix }}€<br/>
                                    {% set sumOfthisProduct = bc.products.prix * bc.quantity %}
                                    - Prix total : {{ sumOfthisProduct }}€<br/>
                                    {% set sumAmountBasket = sumAmountBasket + sumOfthisProduct %}
                                </div>
                            {% else %}
                                Panier vide
                            {% endfor %}
                        </td>
                        <td>{{ sumAmountBasket }}€</td>
                    </tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>

{% endblock %}
